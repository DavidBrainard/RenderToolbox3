<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Render Toolbox 3: Batch Renderer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Render Toolbox 3
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Batch Renderer</div>  </div>
</div><!--header-->
<div class="contents">

<p>Render a family of related scenes based on a Collada parent scene.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga7e0dd5f1d0caa860e7bc12a6005bccbe"><td class="memItemLeft" align="right" valign="top">outFiles&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___batch_renderer.html#ga7e0dd5f1d0caa860e7bc12a6005bccbe">BatchRender</a> (sceneFiles, hints)</td></tr>
<tr class="memdesc:ga7e0dd5f1d0caa860e7bc12a6005bccbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Render multiple scenes at once.  <a href="#ga7e0dd5f1d0caa860e7bc12a6005bccbe"></a><br/></td></tr>
<tr class="separator:ga7e0dd5f1d0caa860e7bc12a6005bccbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga549cc197fbfc7d88e081cfe1c70b7f77"><td class="memItemLeft" align="right" valign="top">pbrtScale mitsubaScale&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___batch_renderer.html#ga549cc197fbfc7d88e081cfe1c70b7f77">ComputeRadiometricScaleFactors</a> ()</td></tr>
<tr class="memdesc:ga549cc197fbfc7d88e081cfe1c70b7f77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate scale factors to bring renderer outputs into radiance units.  <a href="#ga549cc197fbfc7d88e081cfe1c70b7f77"></a><br/></td></tr>
<tr class="separator:ga549cc197fbfc7d88e081cfe1c70b7f77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga190c6aa944cd93e93e37b30295c68ac2"><td class="memItemLeft" align="right" valign="top">hints&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2">GetDefaultHints</a> (hints)</td></tr>
<tr class="memdesc:ga190c6aa944cd93e93e37b30295c68ac2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get default hints that affect the RenderToolbox3 utilities.  <a href="#ga190c6aa944cd93e93e37b30295c68ac2"></a><br/></td></tr>
<tr class="separator:ga190c6aa944cd93e93e37b30295c68ac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab50f49377da2cd26aae23a6f473b7b6"><td class="memItemLeft" align="right" valign="top">SRGBMontage XYZMontage&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___batch_renderer.html#gaab50f49377da2cd26aae23a6f473b7b6">MakeMontage</a> (inFiles, outFile, toneMapFactor, isScale, hints)</td></tr>
<tr class="memdesc:gaab50f49377da2cd26aae23a6f473b7b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Condense several multi-spectral renderings into one sRGB montage.  <a href="#gaab50f49377da2cd26aae23a6f473b7b6"></a><br/></td></tr>
<tr class="separator:gaab50f49377da2cd26aae23a6f473b7b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga837670a7cb23d1a65124a69efb45bc71"><td class="memItemLeft" align="right" valign="top">sceneFiles auxiliaryFiles&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___batch_renderer.html#ga837670a7cb23d1a65124a69efb45bc71">MakeSceneFiles</a> (colladaFile, conditionsFile, mappingsFile, hints, outPath)</td></tr>
<tr class="memdesc:ga837670a7cb23d1a65124a69efb45bc71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make a family of renderer-native scene files based on a Collada parent scene file.  <a href="#ga837670a7cb23d1a65124a69efb45bc71"></a><br/></td></tr>
<tr class="separator:ga837670a7cb23d1a65124a69efb45bc71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga25c9b2e360c10155dbef957406a126ed"><td class="memItemLeft" align="right" valign="top">radianceData scaleFactor&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___batch_renderer.html#ga25c9b2e360c10155dbef957406a126ed">MitsubaDataToRadiance</a> (mitsubaData, mitsubaDoc, hints)</td></tr>
<tr class="memdesc:ga25c9b2e360c10155dbef957406a126ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert Mitsuba multi-spectral data to radiance units.  <a href="#ga25c9b2e360c10155dbef957406a126ed"></a><br/></td></tr>
<tr class="separator:ga25c9b2e360c10155dbef957406a126ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae2618bba0ff8b50e380c740b81d6adf8"><td class="memItemLeft" align="right" valign="top">radianceData scaleFactor&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___batch_renderer.html#gae2618bba0ff8b50e380c740b81d6adf8">PBRTDataToRadiance</a> (pbrtData, pbrtDoc, hints)</td></tr>
<tr class="memdesc:gae2618bba0ff8b50e380c740b81d6adf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert PBRT multi-spectral data to radiance units.  <a href="#gae2618bba0ff8b50e380c740b81d6adf8"></a><br/></td></tr>
<tr class="separator:gae2618bba0ff8b50e380c740b81d6adf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6fd2d45acff1c8042483a4dca9902019"><td class="memItemLeft" align="right" valign="top">conditionsFile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___batch_renderer.html#ga6fd2d45acff1c8042483a4dca9902019">WriteConditionsFile</a> (conditionsFile, names, values)</td></tr>
<tr class="memdesc:ga6fd2d45acff1c8042483a4dca9902019"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write conditions data to a text file.  <a href="#ga6fd2d45acff1c8042483a4dca9902019"></a><br/></td></tr>
<tr class="separator:ga6fd2d45acff1c8042483a4dca9902019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gababf809f1bdb7e2b3f84f927481acd22"><td class="memItemLeft" align="right" valign="top">mappingsFile&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___batch_renderer.html#gababf809f1bdb7e2b3f84f927481acd22">WriteDefaultMappingsFile</a> (colladaFile, mappingsFile, includeFile, reflectances, lightSpectra, excludePattern)</td></tr>
<tr class="memdesc:gababf809f1bdb7e2b3f84f927481acd22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a default mappings file for the given Collada parent scene file.  <a href="#gababf809f1bdb7e2b3f84f927481acd22"></a><br/></td></tr>
<tr class="separator:gababf809f1bdb7e2b3f84f927481acd22"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Render a family of related scenes based on a Collada parent scene. </p>
<p>These functions make up the RenderToolox3 batch renderer, which takes a Collada parent scene file, applies manipulations specified in a conditions file and a mappings file, and produces a family of renderer-native scene files and renderings. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga7e0dd5f1d0caa860e7bc12a6005bccbe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">outFiles BatchRender </td>
          <td>(</td>
          <td class="paramtype">sceneFiles&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hints&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Render multiple scenes at once. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sceneFiles</td><td>cell array of renderer-native scene file names </td></tr>
    <tr><td class="paramname">hints</td><td>struct of RenderToolbox3 options, see <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a></td></tr>
  </table>
  </dd>
</dl>
<p>Renders multiple renderer-native scene files in one batch. <em>sceneFiles</em> should be a cell array of renderer-native scene files, such as those produced by <a class="el" href="group___batch_renderer.html#ga837670a7cb23d1a65124a69efb45bc71" title="Make a family of renderer-native scene files based on a Collada parent scene file.">MakeSceneFiles()</a>. All renderer-native scene files should be intended for the same renderer, which should be specified in <em>hints.renderer</em>.</p>
<p>Mitsuba-native scene files must use Mitsuba's own .xml file format. PBRT-native scene files should use RenderToolbox3's custom PBRT-XML file format with the extension .pbrt.xml, as produced by <a class="el" href="group___utilities.html#ga509d8833e7183548b2b4e36346b1b36b" title="Convert a Collada parent scene file to a PBRT-native scene file.">ColladaToPBRT()</a>. PBRT-native scene files may also use PBRT's own text file format, but these renderings might not be scaled properly into physical radiance units.</p>
<p><em>hints</em> may be a struct with options that affect the rendering process, as returned from <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a>. If <em>hints</em> is omitted, default options are used. For example:</p>
<ul>
<li><em>hints.renderer</em> specifies which renderer to use</li>
<li><em>hints.isParallel</em> specifies whether to render in a "parfor" loop</li>
<li><em>hints.outputDataFolder</em> specefies where to store multi-spectral radiance data files.</li>
<li><em>hints.outputImageFolder</em> specifies where to store RGB image files.</li>
<li><em>hints.isDryRun</em> specefies whether or not to skip actual rendering.</li>
</ul>
<p>Renders each renderer-native scene file in <em>sceneFiles</em>, and writes a new mat-file for each one. Each mat-file will contain a multi-spectral rendering with two variables:</p>
<ul>
<li>multispectralImage - matrix of multi-spectral radiance data with size [height width n]</li>
<li>S - spectral band description for the rendering with elements [start delta n]</li>
</ul>
<p>height and width are pixel image dimensions and n is the number of spectral bands in the image. See the RenderToolbox3 wikiw for more about <a href="https://github.com/DavidBrainard/RenderToolbox3/wiki/Spectrum-Bands">Spectrum Bands</a>.</p>
<p>The each mat-file will also contain metadata about how the scene was rendered:</p>
<ul>
<li>sceneFile - the the name of the renderer-native scene file</li>
<li>hints - the given <em>hints</em> struct, or default hints struct</li>
<li>versionInfo - struct of version information about RenderToolbox3 and its dependencies</li>
<li>commandResult - text output from the shell command that invoked the renderer</li>
</ul>
<p>The multi-spectral data in each .mat file will be scaled into physical radiance units using funtions like <a class="el" href="group___batch_renderer.html#gae2618bba0ff8b50e380c740b81d6adf8" title="Convert PBRT multi-spectral data to radiance units.">PBRTDataToRadiance()</a> and <a class="el" href="group___batch_renderer.html#ga25c9b2e360c10155dbef957406a126ed" title="Convert Mitsuba multi-spectral data to radiance units.">MitsubaDataToRadiance()</a>. These rely on renderer-specific scale factors computed previousy with <a class="el" href="group___batch_renderer.html#ga549cc197fbfc7d88e081cfe1c70b7f77" title="Calculate scale factors to bring renderer outputs into radiance units.">ComputeRadiometricScaleFactors()</a>. Each mat-file will also contain the radiometric scale factor that was used to convert data to radiance units:</p>
<ul>
<li>radiometricScaleFactor - scale factor that was used to bring renderer ouput into physical radiance units</li>
</ul>
<p>Returns a cell array of output mat-file names, with the same dimensions as the given <em>sceneFiles</em>.</p>
<p>Usage: outFiles = <a class="el" href="group___batch_renderer.html#ga7e0dd5f1d0caa860e7bc12a6005bccbe" title="Render multiple scenes at once.">BatchRender(sceneFiles, hints)</a> </p>

</div>
</div>
<a class="anchor" id="ga549cc197fbfc7d88e081cfe1c70b7f77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pbrtScale mitsubaScale ComputeRadiometricScaleFactors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate scale factors to bring renderer outputs into radiance units. </p>
<p>Calculates a radiometric unit scale factor to bring the "raw" output from each renderer into physical radiance units. Uses the ExampleScenes/RadiaceTest recipe to generate renderings with known radiometric properties.</p>
<p>See the RenderToolbox3 wiki for details about &lt;a href="<a href="https://github.com/DavidBrainard/RenderToolbox3/wiki/RadianceTest'">https://github.com/DavidBrainard/RenderToolbox3/wiki/RadianceTest'</a>&gt;Radiometric Unit calculation.</p>
<p>Stores the calculated scale factors for each renderer, using the built-in setpref() function: </p>
<div class="fragment"><div class="line">setpref(<span class="stringliteral">&#39;RenderToolbox3&#39;</span>, <span class="stringliteral">&#39;PBRTRadiometricScale&#39;</span>, pbrtScale);</div>
<div class="line">setpref(<span class="stringliteral">&#39;RenderToolbox3&#39;</span>, <span class="stringliteral">&#39;MitsubaRadiometricScale&#39;</span>, mitsubaScale);</div>
</div><!-- fragment --><p> These persistent values may be modified with setpref(). They may be accessed with getpref() or <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a>.</p>
<p><a class="el" href="group___batch_renderer.html#gae2618bba0ff8b50e380c740b81d6adf8" title="Convert PBRT multi-spectral data to radiance units.">PBRTDataToRadiance()</a> and <a class="el" href="group___batch_renderer.html#ga25c9b2e360c10155dbef957406a126ed" title="Convert Mitsuba multi-spectral data to radiance units.">MitsubaDataToRadiance()</a> use the stored scale factors to convert renderer-specific ouput data into consistent, physical radiance units. <a class="el" href="group___batch_renderer.html#ga7e0dd5f1d0caa860e7bc12a6005bccbe" title="Render multiple scenes at once.">BatchRender()</a> applies these conversions automatically.</p>
<p>Custom scale factors can be used instead of stored scale factors, if they are supplied in a hints struct. For example: </p>
<div class="fragment"><div class="line">hints.PBRTRadiometricScale = myPBRTScale;</div>
<div class="line">hints.MitsubaRadiometricScale = myMitsubaScale;</div>
<div class="line"><a class="code" href="group___batch_renderer.html#ga7e0dd5f1d0caa860e7bc12a6005bccbe" title="Render multiple scenes at once.">BatchRender</a>(..., hints);</div>
</div><!-- fragment --><p>Returns the computed PBRT and Mitsuba radiometric unit scale factors.</p>
<p>Usage: [pbrtScale, mitsubaScale] = <a class="el" href="group___batch_renderer.html#ga549cc197fbfc7d88e081cfe1c70b7f77" title="Calculate scale factors to bring renderer outputs into radiance units.">ComputeRadiometricScaleFactors()</a> </p>

</div>
</div>
<a class="anchor" id="ga190c6aa944cd93e93e37b30295c68ac2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">hints GetDefaultHints </td>
          <td>(</td>
          <td class="paramtype">hints&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get default hints that affect the RenderToolbox3 utilities. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hints</td><td>struct of RenderToolbox3 options, see <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a></td></tr>
  </table>
  </dd>
</dl>
<p>Creates a struct of options that affect the behavior of RenderToolbox3 utilities, or fills in missing parts of a the given <em>hints</em> struct. RenderToolbox3 options include things like renderer name, output image size, and whether to use Matlab's Distributed Computing "parfor" loops.</p>
<p>If provided, <em>hints</em> should be a struct of renderer options with option names as fields. Any missing options will be filled in with default values. If <em>hints</em> is missing or not a struct, creates a new struct with all default values.</p>
<p>Default hint values can be set with Matlab's setpref() function. For example: </p>
<div class="fragment"><div class="line">% <span class="keywordflow">default</span> renderer to use</div>
<div class="line">setpref(<span class="stringliteral">&#39;RenderToolbox3&#39;</span>, <span class="stringliteral">&#39;renderer&#39;</span>, <span class="stringliteral">&#39;Mitsuba&#39;</span>);</div>
<div class="line">% or</div>
<div class="line">setpref(<span class="stringliteral">&#39;RenderToolbox3&#39;</span>, <span class="stringliteral">&#39;renderer&#39;</span>, <span class="stringliteral">&#39;PBRT&#39;</span>);</div>
<div class="line"></div>
<div class="line">% <span class="keywordflow">default</span> ouput image dimensions</div>
<div class="line">setpref(<span class="stringliteral">&#39;RenderToolbox3&#39;</span>, <span class="stringliteral">&#39;imageHeight&#39;</span>, 480);</div>
<div class="line">setpref(<span class="stringliteral">&#39;RenderToolbox3&#39;</span>, <span class="stringliteral">&#39;imageWidth&#39;</span>, 640);</div>
<div class="line"></div>
<div class="line">% review all the hints</div>
<div class="line">hints = <a class="code" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints</a>()</div>
</div><!-- fragment --><p>Returns a new or modified struct of batch renderer hints.</p>
<p>Usage: hints = <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints(hints)</a> Usage examples: </p>
<div class="fragment"><div class="line">hints.whichConditions = [1 3 5];</div>
<div class="line">hints = <a class="code" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints</a>(hints);</div>
<div class="line"><a class="code" href="group___batch_renderer.html#ga7e0dd5f1d0caa860e7bc12a6005bccbe" title="Render multiple scenes at once.">BatchRender</a>(..., hints);</div>
<div class="line"><a class="code" href="group___batch_renderer.html#gaab50f49377da2cd26aae23a6f473b7b6" title="Condense several multi-spectral renderings into one sRGB montage.">MakeMontage</a>(..., hints);</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gaab50f49377da2cd26aae23a6f473b7b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SRGBMontage XYZMontage MakeMontage </td>
          <td>(</td>
          <td class="paramtype">inFiles&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">outFile&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">toneMapFactor&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">isScale&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hints&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Condense several multi-spectral renderings into one sRGB montage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inFiles</td><td>cell array of input mat-file names </td></tr>
    <tr><td class="paramname">outFile</td><td>output montage file name (optional) </td></tr>
    <tr><td class="paramname">toneMapFactor</td><td>how to truncate montage luminance (optional) </td></tr>
    <tr><td class="paramname">isScale</td><td>whether or not to scale montage luminance (optional) </td></tr>
    <tr><td class="paramname">hints</td><td>struct of RenderToolbox3 options, see <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a></td></tr>
  </table>
  </dd>
</dl>
<p>Condenses several multi-spectral renderings stored in mat-files into a single sRGB montage. Tiles the input images so that the montage has roughly the same aspect ratio as the input images.</p>
<p>Attempts to conserve system memory by loading only one multi-spectral image at a time.</p>
<p><em>inFiles</em> must be a cell array of mat-file names, each of which must contain multi-spectral renderer output. <a class="el" href="group___batch_renderer.html#ga7e0dd5f1d0caa860e7bc12a6005bccbe" title="Render multiple scenes at once.">BatchRender()</a> returns such a cell array.</p>
<p><em>outFile</em> determines the file name of the new montage. The file extension determines the file format:</p>
<ul>
<li>If the extension is '.mat', the montage XYZ and sRGB matrices will be saved to a .mat data file.</li>
<li>If the extension matches a standard image format, like '.tiff' or '.png' (default), the sRGB image will be saved in that format, using Matlab's built-in imwrite().</li>
</ul>
<p><em>outFile</em> does not determine where the montage will be saved. The montage will be saved in the folder given by GetOutputPath('outputImageFolder', <em>hints</em>), or if <em>hints</em> is not provided, GetOutputPath('outputImageFolder', <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a>).</p>
<p>If <em>toneMapFactor</em> is provided and greater than 0, montage luminances will be truncated above this factor times the mean luminance of the entire montage.</p>
<p>If isScale is provided and true, montage luminances will be scaled so that the maximum input luminance of the entire montage matches the maximum possible RGB output luminance.</p>
<p><em>hints</em> may be a struct with options that affect the montage, such as the output folder, as returned from <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a>. If <em>hints</em> is omitted, default options are used.</p>
<p>Returns a matrix containing the tone mapped, scaled, sRGB montage with size [height width 3]. Also returns a matrix containing XYZ image data with the same size.</p>
<p>Usage: [SRGBMontage, XYZMontage] = <a class="el" href="group___batch_renderer.html#gaab50f49377da2cd26aae23a6f473b7b6" title="Condense several multi-spectral renderings into one sRGB montage.">MakeMontage(inFiles, outFile, toneMapFactor, isScale, hints)</a> </p>

</div>
</div>
<a class="anchor" id="ga837670a7cb23d1a65124a69efb45bc71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sceneFiles auxiliaryFiles MakeSceneFiles </td>
          <td>(</td>
          <td class="paramtype">colladaFile&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">conditionsFile&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mappingsFile&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hints&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">outPath&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make a family of renderer-native scene files based on a Collada parent scene file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">colladaFile</td><td>file name or path of a Collada parent scene file </td></tr>
    <tr><td class="paramname">conditionsFile</td><td>file name or path of a conditions file </td></tr>
    <tr><td class="paramname">mappingsFile</td><td>file name or path of a mappings file </td></tr>
    <tr><td class="paramname">hints</td><td>struct of RenderToolbox3 options, see <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a> </td></tr>
    <tr><td class="paramname">outPath</td><td>path where to copy new scene files</td></tr>
  </table>
  </dd>
</dl>
<p>Creates a family of renderer-native scene files, based on the given <em>colladaFile</em>, <em>conditionsFile</em>, and <em>mappingsFile</em>. <em>hints.renderer</em> specifies which renderer to make scene files for. <em>outPath</em> is optional, and may specify a folder path that where renderer-native scene files should be writen.</p>
<p><em>colladaFile</em> should be a Collada XML parent scene file. <em>colladaFile</em> may be left empty, if the <em>conditionsFile</em> contains a 'colladaFile' variable.</p>
<p><em>conditionsFile</em> must be a RenderToolbox3 <a href="https://github.com/DavidBrainard/RenderToolbox3/wiki/Conditions-File-Format">Conditions File</a>. <em>conditionsFile</em> may be omitted or left empty, if only one renderer-native scene file is to be produced.</p>
<p><em>mappingsFile</em> must be a RenderToolbox3 <a href="https://github.com/DavidBrainard/RenderToolbox3/wiki/Mappings-File-Format">Mappings File</a>. <em>mappingsFile</em> may be omitted or left empty if only one renderer-native scene file is to be produced, or if <em>conditionsFile</em> contains a 'mappingsFile' variable.</p>
<p><em>hints</em> may be a struct with options that affect the process generating of renderer-native scene files. If <em>hints</em> is omitted, values are taken from <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a>.</p>
<ul>
<li><em>hints.renderer</em> specifies which renderer to make native scene files for.</li>
<li><em>hints.tempFolder</em> is the default location for new renderer-native scene files.</li>
<li><em>hints.adjustmentsFile</em> is a partial scene XML file with renderer-specific values.</li>
<li><em>hints.filmType</em> is a renderer-specific film type to use in the new renderer-native scene files.</li>
<li><em>hints.imageHeight</em> and <em>hints.imageWidth</em> specify the image pixel dimensions to use in the new renderer-native scene files.</li>
<li><em>hints.whichConditions</em> is an array of condition numbers used to select rows from the <em>conditionsFile</em>.</li>
</ul>
<p><em>outPath</em> is optional. If provided, it should be the path to a folder where new renderer-native scene files and related auxiliary files should be copied. The renderer-native scene files will also be written to <em>hints.tempFolder</em>.</p>
<p>Returns a cell array of file names for new renderer-native scene files. By default, each scene file will have the same base name as <em>the</em> given <em>colladaFile</em>, plus a numeric suffix. If <em>conditionsFile</em> contains an 'imageName' variable, each scene file be named with the value of 'imageName'.</p>
<p>Also retrurns a cell array of file names for auxiliary files on which the renderer-native scene files depend, such as image files, spectrum data files, and object geometry files.</p>
<p>Mitsuba-native scene files will use Mitsuba's own .xml file format. PBRT-native scene files will use RenderToolbox3's custom PBRT-XML .xml format. PBRT-XML files can be passed to <a class="el" href="group___batch_renderer.html#ga7e0dd5f1d0caa860e7bc12a6005bccbe" title="Render multiple scenes at once.">BatchRender()</a> for rendering. The can also be converted to PBRT's native text format using <a class="el" href="group___collada_to_p_b_r_t.html#ga3799baf4496f0c4811dd32f629141a49" title="Convert a &quot;node&quot; node from a Collada document to a PBRT-XML document.">WritePBRTFile()</a>.</p>
<p>Usage: [sceneFiles, auxiliaryFiles] = <a class="el" href="group___batch_renderer.html#ga837670a7cb23d1a65124a69efb45bc71" title="Make a family of renderer-native scene files based on a Collada parent scene file.">MakeSceneFiles(colladaFile, conditionsFile, mappingsFile, hints, outPath)</a> </p>

</div>
</div>
<a class="anchor" id="ga25c9b2e360c10155dbef957406a126ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">radianceData scaleFactor MitsubaDataToRadiance </td>
          <td>(</td>
          <td class="paramtype">mitsubaData&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mitsubaDoc&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hints&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert Mitsuba multi-spectral data to radiance units. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mitsubaData</td><td>"raw" data from a Mitsuba scene rendering </td></tr>
    <tr><td class="paramname">mitsubaDoc</td><td>XML DOM document node representing the Mitsuba scene </td></tr>
    <tr><td class="paramname">hints</td><td>struct of RenderToolbox3 options, see <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a></td></tr>
  </table>
  </dd>
</dl>
<p>Scales the given "raw" <em>mitsubaData</em> into physical radiance units. The scaling depends on a Mitsuba-specific scale factor computed previously with <a class="el" href="group___batch_renderer.html#ga549cc197fbfc7d88e081cfe1c70b7f77" title="Calculate scale factors to bring renderer outputs into radiance units.">ComputeRadiometricScaleFactors()</a>. In principle, the scaling might also depend on non-radiometric scene parameters, although this does not seem to be the case for Mitsuba.</p>
<p><em>mitsubaData</em> should be a matrix of multi-spectral data obtained from the Mitsuba renderer, and read into Matlab with a function like <a class="el" href="group___readers.html#ga612881ed326c435e0d2edddee80e2268" title="Read an OpenEXR image with multiple spectral slices.">ReadMultispectralEXR()</a>. Each element of <em>mitsubaData</em> will be scaled into radiance units.</p>
<p><em>mitsubaDoc</em> should be the "document" node of the XML document that represents the rendered scene. Particulars of the scene specification might affect how <em>mitsubaData</em> is scaled.</p>
<p><em>hints</em> should be a struct with additional parameters used during rendering. In particular, <em>hints.MitsubaRadiometricScale</em> may contain the mitsuba-specific scale factor for converting multi-spectral data to radiance units. If <em>hints</em> does not contain this field, the default value will be taken from <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a>.</p>
<p>Returns the given "raw" <em>mitsubaData</em>, scaled into physical radiance units. Also returns the radiance scale factor that was used, which in some cases might differ from <em>hints.MitsubaRadiometricScale</em>.</p>
<p>Usage: [radianceData, scaleFactor] = <a class="el" href="group___batch_renderer.html#ga25c9b2e360c10155dbef957406a126ed" title="Convert Mitsuba multi-spectral data to radiance units.">MitsubaDataToRadiance(mitsubaData, mitsubaDoc, hints)</a> </p>

</div>
</div>
<a class="anchor" id="gae2618bba0ff8b50e380c740b81d6adf8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">radianceData scaleFactor PBRTDataToRadiance </td>
          <td>(</td>
          <td class="paramtype">pbrtData&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pbrtDoc&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hints&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert PBRT multi-spectral data to radiance units. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pbrtData</td><td>"raw" data from a PBRT multi-spectral rendering </td></tr>
    <tr><td class="paramname">pbrtDoc</td><td>XML DOM document node representing the PBRT-XML scene </td></tr>
    <tr><td class="paramname">hints</td><td>struct of RenderToolbox3 options, see <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a></td></tr>
  </table>
  </dd>
</dl>
<p>Scales the given "raw" <em>pbrtData</em> into physical radiance units. The scaling depends on a PBRT-specific scale factor computed previously with <a class="el" href="group___batch_renderer.html#ga549cc197fbfc7d88e081cfe1c70b7f77" title="Calculate scale factors to bring renderer outputs into radiance units.">ComputeRadiometricScaleFactors()</a>. The scaling might also depend on some non-radiometric scene parameters. If these parameters use non-default values, prints a warning that additional scaling might be required.</p>
<p><em>pbrtData</em> should be a matrix of multi-spectral data obtained from the PBRT renderer, and read into Matlab with a function like <a class="el" href="group___readers.html#ga3e3389b35714ba0a7afac464401738a2" title="Get multispectral image data out of a .dat file from Stanford.">ReadDAT()</a>. Each element of <em>pbrtData</em> will be scaled into radiance units.</p>
<p><em>pbrtDoc</em> should be the "document" node of the PBRT-XML document that represents the rendered scene, as returned from <a class="el" href="group___utilities.html#ga509d8833e7183548b2b4e36346b1b36b" title="Convert a Collada parent scene file to a PBRT-native scene file.">ColladaToPBRT()</a>. Parameters stored in the PBRT-XML document might indicate that the scene should be scaled in order to compensate fot non-radiometric factors, like the number of ray samples used per pixel.</p>
<p><em>hints</em> should be a struct with additional parameters used during rendering. In particular, <em>hints.PBRTRadiometricScale</em> may contain the PBRT-specific scale factor for converting multi-spectral data to radiance units. If <em>hints</em> does not contain this field, the default value will be taken from <a class="el" href="group___batch_renderer.html#ga190c6aa944cd93e93e37b30295c68ac2" title="Get default hints that affect the RenderToolbox3 utilities.">GetDefaultHints()</a>.</p>
<p>Returns the given "raw" <em>pbrtData</em>, scaled into physical radiance units. Also returns the radiance scale factor that was used, which in some cases might differ from <em>hints.PBRTRadiometricScale</em>.</p>
<p>Usage: [radianceData, scaleFactor] = <a class="el" href="group___batch_renderer.html#gae2618bba0ff8b50e380c740b81d6adf8" title="Convert PBRT multi-spectral data to radiance units.">PBRTDataToRadiance(pbrtData, pbrtDoc, hints)</a> </p>

</div>
</div>
<a class="anchor" id="ga6fd2d45acff1c8042483a4dca9902019"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">conditionsFile WriteConditionsFile </td>
          <td>(</td>
          <td class="paramtype">conditionsFile&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">names&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">values&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write conditions data to a text file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conditionsFile</td><td>name of new text file to write. </td></tr>
    <tr><td class="paramname">names</td><td>1 x n cell array of string variable names </td></tr>
    <tr><td class="paramname">values</td><td>m x n cell array of variable values</td></tr>
  </table>
  </dd>
</dl>
<p>Writes batch renderer condition variables with the given <em>names</em> and <em>values</em> to a new text file with the given <em>conditionsFile</em> name. See the RenderToolbox3 wiki for more about <a href="https://github.com/DavidBrainard/RenderToolbox3/wiki/Conditions-File-Format">Conditions Files</a>.</p>
<p><em>names</em> will appear in the first line of the new file, separated by tabs. Each of the m rows of <em>values</em> will appear in a separate line, with elements separated by tabs. So, the values for each variable will appear in a tab-separated column.</p>
<p>Attempts to convert numeric values to string, as needed.</p>
<p>Usage: conditionsFile = <a class="el" href="group___batch_renderer.html#ga6fd2d45acff1c8042483a4dca9902019" title="Write conditions data to a text file.">WriteConditionsFile(conditionsFile, names, values)</a> </p>

</div>
</div>
<a class="anchor" id="gababf809f1bdb7e2b3f84f927481acd22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mappingsFile WriteDefaultMappingsFile </td>
          <td>(</td>
          <td class="paramtype">colladaFile&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mappingsFile&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">includeFile&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">reflectances&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lightSpectra&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">excludePattern&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a default mappings file for the given Collada parent scene file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">colladaFile</td><td>file name or path of the Collada parent scene file </td></tr>
    <tr><td class="paramname">mappingsFile</td><td>file name or path for a new mappings file </td></tr>
    <tr><td class="paramname">includeFile</td><td>file name or path for a mappings file to include </td></tr>
    <tr><td class="paramname">reflectances</td><td>cell array of matte material reflectances </td></tr>
    <tr><td class="paramname">lightSpectra</td><td>cell array of light source spectra </td></tr>
    <tr><td class="paramname">excludePattern</td><td>regular expression to filter document elements</td></tr>
  </table>
  </dd>
</dl>
<p>Traverses the Collada document in the given <em>colladaFile</em> and writes a new <em>mappingsFile</em> suitable for use with <a class="el" href="group___batch_renderer.html#ga7e0dd5f1d0caa860e7bc12a6005bccbe" title="Render multiple scenes at once.">BatchRender()</a>. The <em>mappingsFile</em> will specify default values, including:</p>
<ul>
<li>mappings text in <em>includeFile</em> or RenderData/DefaultMappings.txt</li>
<li>matte material for each geometry node</li>
<li>a spectrum for each light source</li>
</ul>
<p>Each material or light source will use a spectrum from a default list, or a provided list.</p>
<p>By default, prepends the text of RenderData/DefaultMappings.txt to the new mappings file. If <em>includeFile</em> is provided it must specify another text file to prepend instead.</p>
<p>By default, each matte material will use one of the Color Checker reflectance spectrums found in RenderData/Macbeth-ColorChecker. If <em>reflectances</em> is provided, it must be a cell array of string reflectance values to use instead.</p>
<p>By default, each light source will use the D65 light spectrum found in RenderData/D65.spd. If <em>lightSpectra</em> is provided, it must be a cell array of string spectrum values to use instead.</p>
<p>By default, writes mappings for all materials and light sources. If <em>excludePattern</em> is provided, it must be a regular expression to match against element id attributes. Elements whose ids match <em>excludePattern</em> will be excluded from the <em>mappingsFile</em>.</p>
<p>Returns the name of the new <em>mappingsFile</em>.</p>
<p>Usage: <a class="el" href="group___batch_renderer.html#gababf809f1bdb7e2b3f84f927481acd22" title="Write a default mappings file for the given Collada parent scene file.">WriteDefaultMappingsFile(colladaFile, mappingsFile, includeFile, reflectances, lightSpectra, excludePattern)</a> </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 29 2013 13:43:55 for Render Toolbox 3 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
